{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.495", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AWS_382", "name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "shortDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "fullDescription": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "help": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1\nResource: aws_security_group.vpc_endpoints[0]"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382"}, {"id": "CKV2_AWS_5", "name": "Ensure that Security Groups are attached to another resource", "shortDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "fullDescription": {"text": "Ensure that Security Groups are attached to another resource"}, "help": {"text": "Ensure that Security Groups are attached to another resource\nResource: aws_security_group.vpc_endpoints[0]"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AWS_382", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infrastructure-catalog/modules/vpc/main.tf"}, "region": {"startLine": 346, "endLine": 379, "snippet": {"text": "resource \"aws_security_group\" \"vpc_endpoints\" {\n  count = length(var.interface_vpc_endpoints) > 0 ? 1 : 0\n\n  name_prefix = \"${var.name}-vpc-endpoints-\"\n  vpc_id      = aws_vpc.main.id\n  description = \"Security group for VPC endpoints\"\n\n  ingress {\n    description = \"HTTPS from VPC\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n\n  egress {\n    description = \"All outbound traffic\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(\n    var.tags,\n    {\n      Name = \"${var.name}-vpc-endpoints-sg\"\n    }\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infrastructure-catalog/modules/vpc/main.tf"}, "region": {"startLine": 346, "endLine": 379, "snippet": {"text": "resource \"aws_security_group\" \"vpc_endpoints\" {\n  count = length(var.interface_vpc_endpoints) > 0 ? 1 : 0\n\n  name_prefix = \"${var.name}-vpc-endpoints-\"\n  vpc_id      = aws_vpc.main.id\n  description = \"Security group for VPC endpoints\"\n\n  ingress {\n    description = \"HTTPS from VPC\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n\n  egress {\n    description = \"All outbound traffic\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(\n    var.tags,\n    {\n      Name = \"${var.name}-vpc-endpoints-sg\"\n    }\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV_AWS_382", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infrastructure-catalog/modules/vpc/main.tf"}, "region": {"startLine": 346, "endLine": 379, "snippet": {"text": "resource \"aws_security_group\" \"vpc_endpoints\" {\n  count = length(var.interface_vpc_endpoints) > 0 ? 1 : 0\n\n  name_prefix = \"${var.name}-vpc-endpoints-\"\n  vpc_id      = aws_vpc.main.id\n  description = \"Security group for VPC endpoints\"\n\n  ingress {\n    description = \"HTTPS from VPC\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n\n  egress {\n    description = \"All outbound traffic\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(\n    var.tags,\n    {\n      Name = \"${var.name}-vpc-endpoints-sg\"\n    }\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n"}}}}]}, {"ruleId": "CKV2_AWS_5", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure that Security Groups are attached to another resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infrastructure-catalog/modules/vpc/main.tf"}, "region": {"startLine": 346, "endLine": 379, "snippet": {"text": "resource \"aws_security_group\" \"vpc_endpoints\" {\n  count = length(var.interface_vpc_endpoints) > 0 ? 1 : 0\n\n  name_prefix = \"${var.name}-vpc-endpoints-\"\n  vpc_id      = aws_vpc.main.id\n  description = \"Security group for VPC endpoints\"\n\n  ingress {\n    description = \"HTTPS from VPC\"\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n\n  egress {\n    description = \"All outbound traffic\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(\n    var.tags,\n    {\n      Name = \"${var.name}-vpc-endpoints-sg\"\n    }\n  )\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n"}}}}]}]}]}